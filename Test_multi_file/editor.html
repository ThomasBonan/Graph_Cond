<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>√âditeur de Sch√©ma ‚Äì Bureau d'√âtudes</title>
  <link rel="stylesheet" href="./style.css" />
  <script src="https://d3js.org/d3.v7.min.js" defer></script>
</head>
<body>
  <header class="page-header">
    <h1>üõ†Ô∏è √âditeur de Sch√©ma ‚Äì Bureau d'√âtudes</h1>
    <nav aria-label="Navigation principale" class="header-actions">
      <button id="theme-toggle" class="btn" aria-pressed="false" title="Basculer le th√®me">‚òÄÔ∏è Th√®me clair</button>
      <a class="btn" href="index.html" id="btn-back">Retour √† l‚Äôinterface commerciale</a>
    </nav>
  </header>

  <main class="layout">
    <!-- Panneau lat√©ral (UI) -->
    <aside class="sidebar" aria-label="Panneau de configuration">
      <section class="panel">
        <h2>Recherche</h2>
        <label for="search-input-editor">Filtrer groupes / options</label>
        <input id="search-input-editor" placeholder="Tape pour filtrer‚Ä¶" autocomplete="off" />
        <p class="hint">Astuce : <kbd>R</kbd> pour recentrer l‚Äôaper√ßu.</p>
      </section>

      <section class="panel">
        <h2>Ajouter un Groupe</h2>
        <label for="group-name">Nom du groupe</label>
        <input id="group-name" placeholder="Nom du groupe" />
        <button id="add-group" class="btn">Ajouter groupe</button>
      </section>

      <section class="panel">
        <h2>Ajouter un Sous-groupe</h2>
        <label for="parent-group-select">Groupe parent</label>
        <select id="parent-group-select"></select>

        <label for="subgroup-name">Nom du sous-groupe</label>
        <input id="subgroup-name" placeholder="Nom du sous-groupe" />
        <button id="add-subgroup" class="btn">Ajouter sous-groupe</button>

        <h3>Groupes et Sous-groupes existants</h3>
        <div id="sidebar">
          <div id="group-tree"></div>
        </div>
      </section>

      <section class="panel">
        <h2>Ajouter une Option</h2>
        <label for="group-select">Groupe</label>
        <select id="group-select"></select>

        <label for="subgroup-select">Sous-groupe</label>
        <select id="subgroup-select"></select>

        <label for="option-name">Nom de l'option</label>
        <input id="option-name" placeholder="Nom de l'option" />

        <fieldset class="fieldset">
          <legend>Statut par gamme</legend>
          <div class="grid-3">
            <label for="gamme-smart">Smart</label>
            <select id="gamme-smart">
              <option value="absent">Absent</option>
              <option value="included">Pr√©sent</option>
              <option value="optional">Optionnelle</option>
            </select>

            <label for="gamme-mod">Mod</label>
            <select id="gamme-mod">
              <option value="absent">Absent</option>
              <option value="included">Pr√©sent</option>
              <option value="optional">Optionnelle</option>
            </select>

            <label for="gamme-evo">Evo</label>
            <select id="gamme-evo">
              <option value="absent">Absent</option>
              <option value="included">Pr√©sent</option>
              <option value="optional">Optionnelle</option>
            </select>
          </div>
        </fieldset>

        <button id="add-option" class="btn btn-primary">Ajouter option</button>
      </section>

      <section class="panel">
        <h2>D√©finir une R√®gle</h2>
        <div class="grid-3">
          <label for="rule-from">De</label>
          <select id="rule-from"></select>

          <label for="rule-type">Type</label>
          <select id="rule-type">
            <option value="requires">D√©pend de</option>
            <option value="incompatible">Incompatible avec</option>
          </select>

          <label for="rule-to">√Ä</label>
          <select id="rule-to"></select>
        </div>

        <label for="rule-set-name">Nom du set de r√®gles (optionnel)</label>
        <input id="rule-set-name" placeholder="Nom du set de r√®gles" />
        <button id="add-rule" class="btn">Ajouter r√®gle</button>

        <h3>R√®gles ajout√©es</h3>
        <ul id="rules-list" class="rules"></ul>
      </section>

      <section class="panel">
        <h2>Exporter</h2>
        <div class="actions-row" style="display:flex; gap:8px; flex-wrap:wrap">
          <button id="export-json" class="btn btn-primary">üì• T√©l√©charger <strong>commercial.json</strong></button>
          <button id="export-legacy" class="btn">‚Ü©Ô∏è Export legacy <strong>gammes.js</strong></button>
        </div>
        <p class="hint">Utilise <strong>commercial.json</strong> dans la version commerciale (recommand√©).</p>
      </section>
    </aside>

    <!-- Zone Aper√ßu -->
    <section class="preview">
      <div class="preview-toolbar">
        <h2>Aper√ßu</h2>
        <div class="right">
          <button id="recenter-btn" class="btn">üîÑ Recentrer la vue (R)</button>
        </div>
      </div>
      <svg id="preview" width="1200" height="800" role="img" aria-label="Aper√ßu du sch√©ma"></svg>
    </section>
  </main>

  <script type="module" src="js/editor-main.js"></script>
</body>
</html>